<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous"/>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"
          integrity="sha384-OHBBOqpYHNsIqQy8hL1U+8OXf9hH6QRxi0+EODezv82DfnZoV7qoHAZDwMwEJvSw"
          crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/react@15/dist/react.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js" crossorigin="anonymous"></script>
    <style>
        .navbar {border-bottom: 1px solid lightgrey !important; }
    </style>
</head>
<body>
<div id="content"></div>
<script type="text/babel">
    /* Request Event REF, note that fields are not always present
    public class Request {
        private final String protocol;
        private final boolean isSecure;
        private final String method;
        private final String path;
        private final String query;
        private final Map<String,List<String>> headers;
        private final String body;
    }
     */
    class LogEntry extends React.Component {
        constructor() {
            super();
            this.state = {
                title: "default title",
                message: "default message",
                value: 0
            };
        }
        increment() {
            this.setState({value: this.state.value + 1})
        }
        render() {
            return (<div className="card animated bounceIn my-1">
                <h5 className="card-header">{this.state.title}</h5>
                <div className="card-body">
                    <h6 className="card-title">Message #{this.props.data.id}</h6>
                    <p className="card-text">{this.state.message} value : {this.state.value}</p>
                    <a href="#" className="btn btn-primary" onClick={() => this.increment()}>Increment value</a>
                </div>
            </div>)
        }
    }
    class App extends React.Component {
        constructor() {
            super();
            this.state = {
                logs: [],
                index: 0
            };
        }
        scrollToBottom = () => {
            const node = ReactDOM.findDOMNode(this.messagesEnd);
            console.log(node);
            node.scrollIntoView({ behavior: 'smooth' });
        };
        componentDidMount() {
            this.scrollToBottom();
        }
        componentDidUpdate() {
            this.scrollToBottom();
        }
        addLog = (event) => {
            event.preventDefault();
            let logs = this.state.logs;
            logs.push({id: this.state.index});
            this.setState({
                logs: logs,
                index: this.state.index + 1
            });
        };
        render() {
            let logEntries = this.state.logs;
            function createEntry(entry) {
                return <LogEntry key={entry.id} data={entry}/>
            }

            let listItems = logEntries.map(createEntry);
            return (
                    <div>
                        <nav className="navbar navbar-expand-md fixed-top bg-light">
                            <a className="navbar-brand" href="#">Watch</a>
                            <button className="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                                <span className="navbar-toggler-icon"/>
                            </button>
                            <div className="collapse navbar-collapse" id="navbarCollapse">
                                <ul className="navbar-nav mr-auto">
                                </ul>
                                <a href="#" className="btn btn-primary" onClick={this.addLog}>Add Log</a>
                            </div>
                        </nav>
                        <div className="container-fluid">
                            {listItems}
                            <div style={{ float:"left", clear: "both" }}
                                 ref={(el) => { this.messagesEnd = el; }}>
                            </div>
                        </div>
                    </div>
            )
        }
    }
    ReactDOM.render(
            <App/>,
        document.getElementById('content')
    );
</script>
</body>
</html>